<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Readme · Stopping.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Stopping.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../idcard/">Stopping&#39;s ID</a></li><li><a class="tocitem" href="../idcard-state/">State&#39;s ID</a></li><li><a class="tocitem" href="../idcard-stoppingmeta/">Meta&#39;s ID</a></li><li><a class="tocitem" href="../howstopcheckoptimality/">Optimality in Stopping</a></li><li><a class="tocitem" href="../example-basic-Newton/">Stopping in action</a></li><li><a class="tocitem" href="../idcard-stopremote/">Stop remote control</a></li><li><a class="tocitem" href="../stop-workflow/">Stopping workflow</a></li><li><a class="tocitem" href="../speak-to-stopping/">Speak to stopping</a></li><li><a class="tocitem" href="../nlpstopping/">NLPStopping</a></li><li><a class="tocitem" href="../lastopping/">LAStopping</a></li><li class="is-active"><a class="tocitem" href>Readme</a><ul class="internal"><li><a class="tocitem" href="#Purpose"><span>Purpose</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#How-to-install"><span>How to install</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Long-Term-Goals"><span>Long-Term Goals</span></a></li></ul></li><li><a class="tocitem" href="../howtostate/">How to State</a></li><li><a class="tocitem" href="../howtostate-nlp/">How to State for NLPs</a></li><li><a class="tocitem" href="../howtostop/">How to Stop</a></li><li><a class="tocitem" href="../howtostop-2/">How to Stop 2</a></li><li><a class="tocitem" href="../howtostop-nlp/">How to Stop for NLPs</a></li><li><a class="tocitem" href="../linear-algebra/">Solve linear algebra</a></li><li><a class="tocitem" href="../buffer/">Use a buffer function</a></li><li><a class="tocitem" href="../fixed-point/">A fixed point algorithm</a></li><li><a class="tocitem" href="../backls/">Backtracking linesearch algorithm</a></li><li><a class="tocitem" href="../uncons/">Unconstrained optimization algorithm</a></li><li><a class="tocitem" href="../active-set/">Active set algorithm</a></li><li><a class="tocitem" href="../penalty/">Quadratic penalty algorithm</a></li><li><a class="tocitem" href="../run-optimsolver/">Run optimization algorithms</a></li><li><a class="tocitem" href="../benchmark/">Benchmark optimization algorithms</a></li><li><a class="tocitem" href="../overfitting/">Overfitting</a></li><li><a class="tocitem" href="../checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../gradient-lbfgs/">Mix algorithms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Readme</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Readme</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/docs/src/index_tuto.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Stopping.jl"><a class="docs-heading-anchor" href="#Stopping.jl">Stopping.jl</a><a id="Stopping.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Stopping.jl" title="Permalink"></a></h1><p>Documentation for Stopping.jl</p><h2 id="Purpose"><a class="docs-heading-anchor" href="#Purpose">Purpose</a><a id="Purpose-1"></a><a class="docs-heading-anchor-permalink" href="#Purpose" title="Permalink"></a></h2><p>Tools to ease the uniformization of stopping criteria in iterative solvers.</p><p>When a solver is called on an optimization model, four outcomes may happen:</p><ol><li>the approximate solution is obtained, the problem is considered solved</li><li>the problem is declared unsolvable (unboundedness, infeasibility ...)</li><li>the maximum available resources are not sufficient to compute the solution</li><li>some algorithm dependent failure happens</li></ol><p>This tool eases the first three items above. It defines a type</p><pre><code class="nohighlight hljs">mutable struct GenericStopping &lt;: AbstractStopping
    problem       :: Any                  # an arbitrary instance of a problem
    meta          :: AbstractStoppingMeta # contains the used parameters and stopping status
    current_state :: AbstractState        # Current information on the problem
    main_stp :: Union{AbstractStopping, Nothing} # Stopping of the main problem, or nothing
    listofstates :: Union{ListStates, Nothing}   # History of states
    user_specific_struct :: Any                  # User-specific structure</code></pre><p>The <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/Stopping/StoppingMetamod.jl">StoppingMeta</a> provides default tolerances, maximum resources, ...  as well as (boolean) information on the result.</p><h3 id="Your-Stopping-your-way"><a class="docs-heading-anchor" href="#Your-Stopping-your-way">Your Stopping your way</a><a id="Your-Stopping-your-way-1"></a><a class="docs-heading-anchor-permalink" href="#Your-Stopping-your-way" title="Permalink"></a></h3><p>The GenericStopping (with GenericState) provides a complete structure to handle stopping criteria. Then, depending on the problem structure, you can specialize a new Stopping by redefining a State and some functions specific to your problem.</p><p>We provide some specialization of the GenericStopping for optimization:</p><ul><li><a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/Stopping/NLPStoppingmod.jl">NLPStopping</a> with <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/State/NLPAtXmod.jl">NLPAtX</a> as a specialized State: for non-linear programming (based on <a href="https://github.com/JuliaSmoothOptimizers/NLPModels.jl">NLPModels</a>);</li><li><a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/Stopping/LinearAlgebraStopping.jl">LAStopping</a> with <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/State/GenericStatemod.jl">GenericState</a>: for linear algebra problems.</li><li><a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/Stopping/LineSearchStoppingmod.jl">LS_Stopping</a> with <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/State/LSAtTmod.jl">LSAtT</a> as a specialized State: for 1d optimization;</li><li>more to come...</li></ul><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><p>The tool provides two main functions:</p><ul><li><code>start!(stp :: AbstractStopping)</code> initializes the time and the tolerance at the starting point and check wether the initial guess is optimal.</li><li><code>stop!(stp :: AbstractStopping)</code> checks optimality of the current guess as well as failure of the system (unboundedness for instance) and maximum resources (number of evaluations of functions, elapsed time ...)</li></ul><p>Stopping uses the informations furnished by the State to evaluate its functions. Communication between the two can be done through the following functions:</p><ul><li><code>update_and_start!(stp :: AbstractStopping; kwargs...)</code> updates the states with informations furnished as kwargs and then call start!.</li><li><code>update_and_stop!(stp :: AbstractStopping; kwargs...)</code> updates the states with informations furnished as kwargs and then call stop!.</li><li><code>fill_in!(stp :: AbstractStopping, x :: Iterate)</code> a function that fill in all the State with all the informations required to correctly evaluate the stopping functions. This can reveal useful, for instance, if the user do not trust the informations furnished by the algorithm in the State.</li><li><code>reinit!(stp :: AbstractStopping)</code> reinitialize the entries of</li></ul><p>the Stopping to reuse for another call.</p><p>Consult the <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/test/examples/runhowto.jl">HowTo tutorial</a> to learn more about the possibilities offered by Stopping.</p><p>You can also access other examples of algorithms in the <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/test/examples/">test/examples</a> folder, which for instance illustrate the strenght of Stopping with subproblems:</p><ul><li>Consult the <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/test/examples/run-optimsolver.jl">OptimSolver tutorial</a> for more on how to use Stopping with nested algorithms.</li><li>Check the <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/test/examples/benchmark.jl">Benchmark tutorial</a> to see how Stopping can combined with <a href="https://juliasmoothoptimizers.github.io/SolverBenchmark.jl/">SolverBenchmark.jl</a>.</li><li>Stopping can be adapted to closed solvers via a buffer function as in <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/test/examples/buffer.jl">Buffer tutorial</a> for an instance with <a href="https://github.com/JuliaOpt/Ipopt.jl">Ipopt</a> via <a href="https://github.com/JuliaSmoothOptimizers/NLPModelsIpopt.jl">NLPModelsIpopt</a>.</li></ul><h2 id="How-to-install"><a class="docs-heading-anchor" href="#How-to-install">How to install</a><a id="How-to-install-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-install" title="Permalink"></a></h2><p>Install and test the Stopping package with the Julia package manager:</p><pre><code class="language-julia hljs">pkg&gt; add Stopping
pkg&gt; test Stopping</code></pre><p>You can access the most up-to-date version of the Stopping package using:</p><pre><code class="language-julia hljs">pkg&gt; add https://github.com/SolverStoppingJulia/Stopping.jl
pkg&gt; test Stopping
pkg&gt; status Stopping</code></pre><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>As an example, a naive version of the Newton method is provided <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/test/examples/newton.jl">here</a>. First we import the packages:</p><pre><code class="nohighlight hljs">using LinearAlgebra, NLPModels, Stopping</code></pre><p>We consider a quadratic test function, and create an uncontrained quadratic optimization problem using <a href="https://github.com/JuliaSmoothOptimizers/NLPModels.jl">NLPModels</a>:</p><pre><code class="nohighlight hljs">A = rand(5, 5); Q = A&#39; * A;
f(x) = 0.5 * x&#39; * Q * x
nlp = ADNLPModel(f,  ones(5))</code></pre><p>We now initialize the <em>NLPStopping</em>. First create a State.</p><pre><code class="nohighlight hljs">nlp_at_x = NLPAtX(ones(5))</code></pre><p>We use <a href="https://github.com/SolverStoppingJulia/Stopping.jl/blob/master/src/Stopping/nlp_admissible_functions.jl">unconstrained_check</a> as an optimality function</p><pre><code class="nohighlight hljs">stop_nlp = NLPStopping(nlp, nlp_at_x, optimality_check = unconstrained_check)</code></pre><p>Note that, since we used a default State, an alternative would have been:</p><pre><code class="nohighlight hljs">stop_nlp = NLPStopping(nlp)</code></pre><p>Now a basic version of Newton to illustrate how to use Stopping.</p><pre><code class="nohighlight hljs">function newton(stp :: NLPStopping)

    #Notations
    pb = stp.pb; state = stp.current_state;
    #Initialization
    xt = state.x

    #First, call start! to check optimality and set an initial configuration
    #(start the time counter, set relative error ...)
    OK = update_and_start!(stp, x = xt, gx = grad(pb, xt), Hx = hess(pb, xt))

    while !OK
        #Compute the Newton direction (state.Hx only has the lower triangular)
        d = (state.Hx + state.Hx&#39; - diagm(0 =&gt; diag(state.Hx))) \ (- state.gx)
        #Update the iterate
        xt = xt + d
        #Update the State and call the Stopping with stop!
        OK = update_and_stop!(stp, x = xt, gx = grad(pb, xt), Hx = hess(pb, xt))
    end

    return stp
end</code></pre><p>Finally, we can call the algorithm with our Stopping:</p><pre><code class="nohighlight hljs">stop_nlp = newton(stop_nlp)</code></pre><p>and consult the Stopping to know what happened</p><pre><code class="nohighlight hljs">#We can then ask stop_nlp the final status
@test :Optimal in status(stop_nlp, list = true)
#Explore the final values in stop_nlp.current_state
printstyled(&quot;Final solution is $(stop_nlp.current_state.x)&quot;, color = :green)</code></pre><p>We reached optimality, and thanks to the Stopping structure this simple looking algorithm verified at each step of the algorithm:</p><ul><li>time limit has been respected;</li><li>evaluations of the problem are not excessive;</li><li>the problem is not unbounded (w.r.t. x and f(x));</li><li>there is no NaN in x, f(x), g(x), H(x);</li><li>the maximum number of iteration (call to stop!) is limited.</li></ul><h2 id="Long-Term-Goals"><a class="docs-heading-anchor" href="#Long-Term-Goals">Long-Term Goals</a><a id="Long-Term-Goals-1"></a><a class="docs-heading-anchor-permalink" href="#Long-Term-Goals" title="Permalink"></a></h2><p>Stopping is aimed as a tool for improving the reusability and robustness in the implementation of iterative algorithms. We warmly welcome any feedback or comment leading to potential improvements.</p><p>Future work will address more sophisticated problems such as mixed-integer optimization problems, optimization with uncertainty. The list of suggested optimality functions will be enriched with state of the art conditions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lastopping/">« LAStopping</a><a class="docs-footer-nextpage" href="../howtostate/">How to State »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 24 June 2022 14:23">Friday 24 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
